---
title: "OAuthとOIDCの概要と目的の違い"
---

## OAuth とは

OAuth は、**リソースの所有者が、リソースへのアクセス権を第三者に与える仕組み**です。

RFC 6749 では、OAuth を以下のように定義しています。

> OAuth 2.0 は, サードパーティーアプリケーションによる HTTP サービスへの限定的なアクセスを可能にする認可フレームワークである
>
> — [RFC 6749](https://www.rfc-editor.org/rfc/rfc6749)

### 具体例：写真印刷サービス

例えば、自分の写真を Google Photos のようなオンラインアルバムサービスで管理しているとします。
このアルバムサービスとは別の印刷サービスに、自分の写真を印刷してもらいたい場合を考えてみましょう。

従来であれば、印刷サービスに Google のパスワードを教え、自分の代わりに写真にアクセスしてもらう必要がありました。
しかし、それはセキュリティ上大きなリスクです。

OAuth を使えば、**「印刷サービスにだけ、特別に、自分の写真を見る権限を与える」** ということが実現できます。

具体的には、**アクセストークン**と呼ばれる「鍵」を利用することで、リソースへのアクセスが可能になります。
自分の写真を見る権限のみを持つアクセストークンを印刷サービスに渡すことで、印刷サービスは自分の写真を見ることができるようになります。

## OIDC とは

OIDC（OpenID Connect）は、
**ユーザの本人確認（認証）とプロフィール情報の取得を行うための仕組み**です。

ソーシャルログイン、という言葉が馴染み深いかもしれません。

OpenID Connect Core 1.0 では、以下のように定義されています。

> OpenID Connect 1.0 は, OAuth 2.0 プロトコルの上にシンプルなアイデンティティレイヤーを付与したものである
>
> — [OpenID Connect Core 1.0](https://openid.net/specs/openid-connect-core-1_0.html)

### 具体例：Google アカウントでのログイン

例えば、Zenn のようなサービスにログインする場合を考えてみましょう。

「Google でログイン」ボタンをクリックすると、Google のログイン画面が表示されます。
Google アカウントでログインすると、Zenn に戻り、ログインが完了します。

このとき Zenn は内部で、 Google から「このユーザは確かに Google アカウントを持っており、このようなプロフィール情報を持っている」という情報を受け取っています。

具体的には、**ID トークン**と呼ばれるプロフィール証明書のようなトークンを利用することで、ユーザのプロフィールを提示し、これを第三者が信頼することでログインを行うことができます。

## 目的の違い

OAuth と OIDC は、**目的が全く異なるユースケース**に対応しています。

| 項目             | OAuth                                          | OIDC                              |
| ---------------- | ---------------------------------------------- | --------------------------------- |
| **目的**         | リソースに対する認可                           | ユーザの本人確認（認証）          |
| **主な用途**     | 第三者サービスにリソースへのアクセス権を与える | 第三者サービスにログインする      |
| **取得するもの** | アクセストークン                               | ID トークン（+ アクセストークン） |

この特性を踏まえ、OAuth は **認可のプロトコル**、OIDC は **認証のプロトコル** として設計されています。

### 認可と認証の違い

- **認可（Authorization）**: 「何ができるか」を許可すること
  - 例：印刷サービスに写真を読み取る権限を与える
- **認証（Authentication）**: 「誰であるか」を確認すること
  - 例：このユーザが確かに山田太郎であると確認する

:::message alert
**OAuth を認証に転用してはいけません（OAuth 認証の禁止）**

OAuth は認可のプロトコルであり、認証の仕組みとしては設計されていません。
OAuth を認証に転用すると意図されない使われ方となり、セキュリティ上の問題が発生する可能性があります。

詳細は後の章で解説しますが、認証が必要な場合は OIDC を使用しましょう。「餅は餅屋」です。
:::

## しかし技術的には「追加レイヤー」

目的は異なりますが、OIDC は技術的には **OAuth の上に構築された追加レイヤー**です。

OIDC の仕様の多くは OAuth の仕組みを流用しており、両者を明確に切り分けることが難しい部分もあります。
例えば、OIDC の `/userinfo` エンドポイントはアクセストークンを使ってプロフィール情報を取得するため、OAuth の認可の仕組みを利用しています。

また、OIDC 側で発祥した仕様が OAuth 側に逆輸入されることもあります。

したがって、**OIDC を理解するためには、まず OAuth の理解が不可欠**です。

本書では、まず OAuth をしっかりと理解してから OIDC の解説に進む構成を採用しています。
では、次の章から OAuth の基礎を学んでいきましょう。
