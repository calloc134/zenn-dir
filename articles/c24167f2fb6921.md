---
title: "授業内開発で部室予約システムを開発した"
emoji: "🏫 "
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["Hono", "PostgreSQL", "React", "shadcn", "大学"]
published: true
---

# はじめに

こんにちは。calloc134 です。

前回の授業内ハッカソン記事、200 いいねありがとうございます！
https://zenn.dev/calloc134/articles/c5ae165b16b969

自分の大学では、これ以外にも授業内で開発を行う実践的な授業がいくつか存在します。
この中で、部室予約システムを開発した授業について紹介します。

# 簡単な概要

この授業では、チームで開発の分担を行いながら決められた期限までにコンテンツを制作していきます。自分は後輩とチームを組み、開発を行いました。
本来であればここで開発する内容は静的サイトで十分なのですが、せっかくなので動的サイトを作ることにしました。
後輩に聞いてみたところ、
「自分は軽音楽部に所属しているので、練習室の予約システムを作りたい」とのことでした。
丁度いい機会だと思い、自分の気になっている技術を利用しながら開発を行っていくことを決めました。

# 仕様

部室予約システムは、以下の機能を持つことにしました。

## 機能要件

- ユーザは部室の予約を行うことができる
- ユーザは部室の予約をキャンセルすることができる
- 管理者が部屋の利用禁止枠を設定できる

詳細は以下のとおりです。

- 予約の出来る日時は平日のみ
- 予約は大学の授業の単位と同じ(四時限目まで・一日 4 コマ)
- 過去・当日の予約は禁止
- 一週間以内に予約がある場合は予約できない
- 予約の取り消しは 3 日前まで

## 非機能要件

- レスポンシブデザインに対応
- 認証に対応
  - パスワード認証だけではなく、SNS 連携も可能

この条件に沿って、技術選定を行いました。

## 技術選定

ここで、それぞれの要件を達成するため、以下のような技術選定を行いました。

- バックエンドインフラ
  -Cloudflare Workers
- バックエンド FW
  - Hono
- バックエンド データベースクエリビルダ
  - safeql
- 認証サービス
  - Clerk
- データベース
  - Neon Database
- フロントエンド FW
  - React
- フロントエンド ルーティング
  - Tanstack Router
- フロントエンド サーバサイドキャッシュ
  - Tanstack Query (React Query)
- フロントエンド UI
  - Tailwind CSS
  - shadcn
- フロントエンド ビルドツール
  - Vite
- フロントエンド ライブラリ
  - react-hot-toast
  - react-spinners

では、それぞれの技術について解説します。

## バックエンド

### Cloudflare Workers

https://workers.cloudflare.com/

Cloudflare が提供する、TypeScript のサーバレスアプリケーションをホストするための環境です。無料で提供されており、エッジで動作するため、レイテンシが低いことがメリットの一つです。リソース制限は比較的厳しいため、効率的なコードを書く必要があります。

### Hono

https://hono.dev/

TypeScript のバックエンドアプリケーションを記述するためのフレームワークです。Express に似た API を持っており、簡単に API を記述することができます。また、Zod や Valibot のようなバリデーションライブラリや、後述する Clerk をはじめとする IDaaS の認証を判定するようなミドルウェアを多く提供しており、サポートが手厚いことが特徴です。

### safeql

https://safeql.dev/

TypeScript で動作する PostgreSQL 用のクエリビルダ・SQL 構文バリデータです。eslint ルールで記述が行われており、sql タグで囲まれた SQL 文を PostgreSQL で検証し、SQL 文が正常に動作するかを保証します。また、ジェネリクスに対し SQL の結果を解析して型を生成します。これにより、SQL の実行結果に型が付与され、TypeScript の型安全性を保証します。

ORM に対してこれを選んだ理由としては、SQL を直接書きながら型の安全性を保証することができる oss として使ってみたい気持ちがあったためです。
TypeScript では Prisma ORM や Drizzle ORM が有名ですが、ORM を利用しているとどうしても表現力に限界が生じます。また、普段の開発で ORM を利用しているため、本来の SQL を十分に学習できていないと感じていたからです。
前回の授業内ハッカソンでは Drizzle ORM を利用していたのですが、以上の理由により、今回は ORM を使わずに SQL を直接書くことにしました。

### Neon Database

https://neon.tech/

サーバレスで動作するデータベースであり、SaaS として提供されています。PostgreSQL と互換性があり、SQL を利用してデータベースを操作することができます。
safeql を利用するため PostgreSQL を利用する必要があり、このサービスを選択しました。
本当は PlanetScale を利用してみたいと思っていたのですが、Hobby Plan が終了してしまったため、こちらを選択しました。

### Clerk

https://clerk.dev/

IDaaS の認証サービスです。ユーザの管理や操作が簡単にでき、また他サービスとの連携も容易です。また、Hono との連携が可能です。
自分は以前 Auth0 を利用していたのですが、一度 Clerk を利用してみようと思い、今回はこちらを選択しました。
前回の授業内ハッカソンでは自前で認証を実装していましたが、今回は Clerk を利用することで、認証周りの実装を比較的簡単に行うことができました。

## フロントエンド

### React

https://react.dev/

使い慣れているため、今回も React を利用しました。

### Tanstack Router

https://tanstack.com/router/latest

前回と同じく、Tanstack Router を利用しました。React のルーティングを行うためのライブラリであり、型安全にルーティングを行うことができます。

### Tanstack Query (React Query)

https://tanstack.com/query/latest

前回と同じく、Tanstack Query を利用しました。React のサーバサイドキャッシュを行うためのライブラリであり、効率化されたデータの取得を行うことができます。

### Tailwind CSS

https://tailwindcss.com/

Tailwind CSS を利用してデザインを行いました。

### shadcn/ui

https://ui.shadcn.com/

Tailwind CSS を利用してデザインを行うことの出来る UI コンポーネントライブラリです。内部では Radix UI と呼ばれるヘッドレスコンポーネントライブラリを利用しており、デザインに Tailwind CSS を利用することができます。

### react-hot-toast

https://react-hot-toast.com/

通知を表示するためのライブラリです。今回は予約作成・削除の際に通知を表示するために利用しました。

### react-spinners

https://www.davidhu.io/react-spinners/

ローディングアニメーションを表示するためのライブラリです。

# データベース設計
