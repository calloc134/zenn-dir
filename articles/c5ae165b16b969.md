---
title: "å¤§å­¦ã®æˆæ¥­ã§Cloudflareä½¿ã„ã¾ãã£ã¦è‡ªå·±æº€è¶³é–‹ç™ºã—ãŸ"
emoji: "ğŸ”¥"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Cloudflare", "Hono", "Drizzle"]
published: true
---

ã“ã‚“ã«ã¡ã¯ã€‚ã‹ã‚ã£ãã§ã™ã€‚

ä»Šå›ã¯ä¸€è¨€ã§ã„ã†ã¨

> å¤§å­¦ã®æˆæ¥­ã§"å‡ºå¸­ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ "ã‚’ä½œã‚‹ã“ã¨ã«ãªã‚Šã¾ã—ãŸ
> ã›ã£ã‹ããªã®ã§ Cloudflare ã®ã‚¤ãƒ³ãƒ•ãƒ©ã§æœ€æ–°æŠ€è¡“ã‚’ä½¿ã„ã¾ãã‚Šã¾ã—ãŸ
> æ¥½ã—ã‹ã£ãŸã§ã™

ã¨ã„ã†æ„Ÿã˜ã®ãŠè©±ã‚’ã—ã¾ã™ã€‚

## ã¯ã˜ã‚ã«

è‡ªåˆ†ã®å¤§å­¦ã§è¡Œã‚ã‚Œã¦ã„ã‚‹æˆæ¥­ã«ã€ã€ŒPBL æ¦‚è«–ã€ã¨ã„ã†ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã®æˆæ¥­ã§ã¯ã€ç”Ÿå¾’ãŒè‡ªåˆ†ãŸã¡ã§è§£æ±ºã—ãŸã„ãƒ†ãƒ¼ãƒã‚’æ±ºã‚ã€ãã‚Œã«æ²¿ã£ã¦ä½œå“ã‚’é–‹ç™ºã—ã¦ã„ãå®Ÿè·µçš„ãªæˆæ¥­ã§ã™(æˆæ¥­ã¨ã„ã†ã‚ˆã‚Šã€ãƒãƒƒã‚«ã‚½ãƒ³ã«è¿‘ã„æ„Ÿã˜ã®æ¼”ç¿’ã§ã™)ã€‚

ãƒ†ãƒ¼ãƒã¨ã—ã¦ã¯ã€ã€Œæˆæ¥­ã®ä¸æº€ã‚’è§£æ¶ˆã™ã‚‹ã€ã€Œç”Ÿå¾’ã®ç”Ÿæ´»ã‚’ä¾¿åˆ©ã«ã™ã‚‹ã€ãªã©ã€ç”Ÿå¾’ãŒç›´æ¥é–¢ã‚ã‚‹ã‚‚ã®ãŒå¤šã„ã§ã™ã€‚

æˆæ¥­ã®ä¸æº€ã‚’ãƒ’ã‚¢ãƒªãƒ³ã‚°ã—ãŸã¨ã“ã‚ã€å‡ºå¸­ç®¡ç†ã«é–¢ã™ã‚‹ä¸æº€ã¨ã—ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒã‚¤ãƒ³ãƒˆãŒæŒ™ãŒã‚Šã¾ã—ãŸã€‚

- å‡ºå¸­åˆ¤å®šãŒã‚«ãƒ¼ãƒ‰ã®ã‚¿ãƒƒãƒã§è¡Œã‚ã‚Œã‚‹ãŸã‚ã€æ‰‹é–“ãŒã‹ã‹ã‚‹
- ã‚«ãƒ¼ãƒ‰ã‚’å¿˜ã‚Œã‚‹ã¨å‡ºå¸­ãŒå–ã‚Œãªã„
- å‡ºå¸­ã—ãŸã¨ãã«ä½•ã‚‰ã‹ã®æ‰‹æ®µã§é€šçŸ¥ãŒæ¬²ã—ã„

ãã“ã§ã€ã“ã‚Œã‚‰ã®ä¸æº€ã‚’è§£æ¶ˆã™ã‚‹ãŸã‚ã«ã€å‡ºå¸­ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½œã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚

## å‡ºå¸­ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®æ¦‚è¦

ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½œæˆã™ã‚‹ã«ã‚ãŸã£ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ãªè¦ä»¶ã‚’å®šã‚ã¾ã—ãŸã€‚

- å‡ºå¸­åˆ¤å®šã¯ã€ç”Ÿå¾’ã® Bluetooth ã‚’æ¤œçŸ¥ã™ã‚‹ã“ã¨ã§è¡Œã†
- å‡ºå¸­ã®å†…å®¹ã‚’ã€ç”Ÿå¾’ã® e ãƒ¡ãƒ¼ãƒ«ã§é€šçŸ¥ã§ãã‚‹ã‚ˆã†ã«ã—ãŸã„
- å‡ºå¸­å†…å®¹ã‚’ Web ãƒšãƒ¼ã‚¸ã‹ã‚‰ç¢ºèªã—ãŸã„
- æ•™å¸«ã‚‚åŒã˜ã‚ˆã†ã«å‡ºå¸­ã‚’ç¢ºèªã§ãã‚‹ã‚ˆã†ã«ã—ãŸã„

ã¾ãŸã€ä»Šå¾Œã®åˆ©ç”¨æ€§å‘ä¸Šã«å‘ã‘ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ãªæ–¹é‡ã‚‚å®šã‚ã¾ã—ãŸã€‚

- å‡ºå¸­åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯éƒ¨åˆ†ã® API ã‚¹ã‚­ãƒ¼ãƒã‚’ä»•æ§˜ã¨ã—ã¦
  å‡ºå¸­èªè­˜éƒ¨åˆ†ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’å¤–éƒ¨ã‹ã‚‰æ‹¡å¼µã§ãã‚‹ã‚ˆã†ã«ã—ãŸã„

:::message

ä»Šå›ã¯ Bluetooth æ¤œçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã‚‚æœ€ä½é™å®Ÿè£…ã—ã¾ã—ãŸãŒã€ã“ã®è¨˜äº‹ã§ã¯å‡ºå¸­ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®ã¿ã«ã¤ã„ã¦è¨˜è¿°ã—ã¾ã™ã€‚
ã‚·ã‚¹ãƒ†ãƒ ã¨ã—ã¦ã¯ API ã«æ²¿ã£ã¦æˆæ¥­ ID ã¨ç”Ÿå¾’ã®ãƒ‡ãƒã‚¤ã‚¹ ID ãƒªã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã‚‚ã®ã§ã‚ã‚‹ãŸã‚ã€Bluetooth æ¤œçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã¯ Bluetooth ã«ä¾å­˜ã›ãšã€åˆ¥é€”å®Ÿè£…ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
:::

## å‡ºå¸­ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

å‡ºå¸­ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

### ãƒ†ãƒ¼ãƒ–ãƒ«

- ç”Ÿå¾’ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«
- æ•™å¸«ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«
- æˆæ¥­ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«
- å±¥ä¿®ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«
- å‡ºå¸­ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«

### ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

- æ•™å¸«ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ã€æˆæ¥­ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ 1 å¯¾å¤šã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- ç”Ÿå¾’ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ã€å±¥ä¿®ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ 1 å¯¾å¤šã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- æˆæ¥­ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ã€å±¥ä¿®ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ 1 å¯¾å¤šã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- ç”Ÿå¾’ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ã€å‡ºå¸­ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ 1 å¯¾å¤šã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- æˆæ¥­ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ã€å‡ºå¸­ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ 1 å¯¾å¤šã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

## æŠ€è¡“é¸å®š

ä»Šå›æŠ€è¡“é¸å®šã™ã‚‹ã«ã‚ãŸã£ã¦ã€æ˜¯é Cloudflare Workers ã¨ Cloudflare Pages ã‚’ä½¿ã„ãŸã„ã¨æ€ã„ã¾ã—ãŸã€‚

ç†ç”±ã¨ã—ã¦ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚

- Cloudflare Workers ã§ã®é–‹ç™ºãŒæœ€è¿‘ãƒ–ãƒ¼ãƒ ã«ãªã£ã¦ãŠã‚Šã€ä¸€åº¦ä½¿ã£ã¦ã¿ãŸã‹ã£ãŸãŸã‚
- ä»¥å‰ã®ãƒãƒƒã‚«ã‚½ãƒ³ã§ Cloudflare Pages ã‚’ä½¿ã£ãŸã“ã¨ãŒã‚ã‚Šã€ã¨ã¦ã‚‚ä½¿ã„ã‚„ã™ã‹ã£ãŸçµŒé¨“ãŒã‚ã‚‹ãŸã‚
- Cloudflare Workers ã§ã¯ D1 ã¨ã„ã†ã‚¨ãƒƒã‚¸ã§å‹•ããƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒä½¿ãˆã‚‹ãŸã‚
- Cloudflare Workers ã§ã¯ KV ã¨ã„ã†ã‚¨ãƒƒã‚¸ã§å‹•ãã‚­ãƒ¼ãƒãƒªãƒ¥ãƒ¼ã‚¹ãƒˆã‚¢ãŒä½¿ãˆã‚‹ãŸã‚

## Cloudflare Workers ã§ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™º

Cloudflare Workers ã§ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºã‚’ã™ã‚‹ã«ã‚ãŸã‚Šã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’ Hono ã§é–‹ç™ºã™ã‚‹ã“ã¨ã‚’æ±ºå®šã—ã¾ã—ãŸã€‚

Hono ã¯ã€Cloudflare Workers ã§ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ã€ãƒ¢ãƒ€ãƒ³ãªãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™ã€‚ä¸åº¦ Express.js ã®ãƒ¢ãƒ€ãƒ³ç‰ˆã®ã‚ˆã†ãªæ„Ÿã˜ã§ã™ã­ã€‚

https://hono.dev/

https://zenn.dev/azukiazusa/articles/hono-cloudflare-workers-rest-api

Cloudflare Workers ã§ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºã‚’ã™ã‚‹ã«ã‚ãŸã‚Šã€Hono ã¯æœ€é©ãªé¸æŠè‚¢ã§ã—ãŸã€‚

ã¾ãŸã€Cloudflare Workers D1 ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ‰‹æ³•ã¨ã—ã¦ã€Drizzle ORM ã‚’é¸æŠã—ã¾ã—ãŸã€‚
https://zenn.dev/mizchi/articles/d1-drizzle-orm

ãã®ä»–ã€Cloudflare Workers ã§ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºã«ã‚ãŸã‚Šã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¾ã—ãŸã€‚

- hono/jwt - JWT ã®ç”Ÿæˆã¨æ¤œè¨¼ã‚’è¡Œã†ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒª(middleware ã¨ã—ã¦ä½¿ç”¨)
- ulidx - ãƒ¦ãƒ‹ãƒ¼ã‚¯ãª ID ã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- bcrypt-js - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ãƒãƒƒã‚·ãƒ¥åŒ–ã‚’è¡Œã†ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

å‚è€ƒãƒªãƒ³ã‚¯ã‚’ä»¥ä¸‹ã«è¨˜è¼‰ã—ã¾ã™ã€‚

https://hono.dev/middleware/builtin/jwt
https://github.com/perry-mitchell/ulidx
https://github.com/dcodeIO/bcrypt.js

ã•ã‚‰ã«ã€E ãƒ¡ãƒ¼ãƒ«ã®é€ä¿¡ã‚’æ‹…å½“ã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã€Resend.com ã‚’é¸æŠã—ã¾ã—ãŸã€‚

https://resend.com/

## Cloudflare Pages ã§ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™º

Cloudflare Pages ã§ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã‚’ã™ã‚‹ã«ã‚ãŸã‚Šã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’ React ã§é–‹ç™ºã™ã‚‹ã“ã¨ã‚’æ±ºå®šã—ã¾ã—ãŸã€‚

ã¾ãŸã€è‡ªåˆ†ãŒä½¿ã„æ…£ã‚Œã¦ã„ã‚‹ä»¥ä¸‹ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç¾¤ã‚’æ¡ç”¨ã—ã¾ã—ãŸã€‚

- React
- Panda CSS - CSS ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- Park UI - React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒª (ãƒ‰ãƒ­ãƒ¯ãƒ¼ã‚„ãƒ¢ãƒ¼ãƒ€ãƒ«ãªã©ã® UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’åˆ©ç”¨)
- Tanstack Query - ã‚¯ã‚¨ãƒªã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- Tantack Router - å‹å®‰å…¨ãªãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- react-hot-toast - ãƒˆãƒ¼ã‚¹ãƒˆè¡¨ç¤ºãƒ©ã‚¤ãƒ–ãƒ©ãƒª

å‚è€ƒãƒªãƒ³ã‚¯ã‚’ä»¥ä¸‹ã«è¨˜è¼‰ã—ã¾ã™ã€‚

https://panda-css.com/
https://tanstack.com/query/latest
https://tanstack.com/router/v1
https://react-hot-toast.com/

## è©°ã¾ã£ãŸã¨ã“ã‚ãƒ»å·¥å¤«ç‚¹

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: Hono ã‚’ä½¿ã£ãŸã“ã¨ãŒãªã‹ã£ãŸ

Hono ã‚’ä½¿ã£ãŸã“ã¨ãŒãªã‹ã£ãŸãŸã‚ã€æœ€åˆã¯ã©ã†ã‚„ã£ã¦ä½¿ãˆã°ã„ã„ã®ã‹ã‚ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚çµå±€å…¬å¼ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’èª­ã¿ãªãŒã‚‰ã®é–‹ç™ºã«ãªã£ãŸã¨ãŠã‚‚ã„ã¾ã™ã€‚

https://hono.dev/getting-started/cloudflare-workers

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: Drizzle ORM ã®æ´»ã‹ã—æ–¹ã«è‹¦æˆ¦ã—ãŸ

Drizzle ORM ã¯ã€ç‰¹æ€§ä¸Šç”Ÿã® SQL ã«è¿‘ã„å½¢ã§ã‚¯ã‚¨ãƒªã‚’æ›¸ãã“ã¨ã«ãªã‚Šã¾ã™ã€‚
è‡ªåˆ†ã¯ã“ã‚Œã¾ã§ Prisma ORM ã‚’ä¸»ã«ä½¿ã£ã¦ã„ãŸã®ã§ã™ãŒã€Prisma ã¨ã¯é•ã†ä½¿ã„å‹æ‰‹ã«è‹¦æˆ¦ã—ã€ä»Šã¾ã§ SQL ã¨ã¾ã¨ã‚‚ã«å‘ãåˆã£ã¦ã“ãªã‹ã£ãŸè‡ªåˆ†ã®ç”˜ã•ã‚’ç—›æ„Ÿã—ã¾ã—ãŸã€‚

ã¾ãŸã€Drizzle ORM è‡ªä½“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒå®Ÿéš›ã® API ã¨ä¹–é›¢ã—ã¦ã„ã‚‹éƒ¨åˆ†ãŒå¤šãã€è‹¦æˆ¦ã—ã¾ã—ãŸã€‚

![SQLã‚¨ã‚¢ãƒ—ã§ã”ã‚ã‚“](/images/c5ae165b16b969/2023-12-20-18-24-57.png)

SQL ã‚¨ã‚¢ãƒ—ã§ã”ã‚ã‚“ãƒ»ãƒ»ãƒ»ã€‚

Select ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã£ã¦ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã•ã‚ŒãŸãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ãŸã‚Šã—ãŸã®ã§ã™ãŒã€ãªãœã‹ãƒ‡ãƒ¼ã‚¿ã«ã‚ºãƒ¬ãŒç”Ÿã˜ã¦ã—ã¾ã£ãŸã‚Šãƒ»ãƒ»ãƒ»ã€‚
çµå±€ã€ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã‚’ã‚¹ã‚­ãƒ¼ãƒã®æ–¹ã§è¨­å®šã—ã€Drizzle ORM ã®æä¾›ã—ã¦ã„ã‚‹ query ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨ã„ã¦ã‚ˆã†ã‚„ãè§£æ±ºã—ã¾ã—ãŸã€‚

:::details ã‚¹ã‚­ãƒ¼ãƒã®å®šç¾©

```ts
import { relations } from "drizzle-orm";
import { sqliteTable, integer, text } from "drizzle-orm/sqlite-core";

// ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©
// ãƒ†ãƒ¼ãƒ–ãƒ«å: student
// ç”Ÿå¾’ã‚’ç®¡ç†ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«
const student = sqliteTable("student", {
  student_uuid: text("student_uuid").primaryKey().notNull(),
  student_id: integer("student_id").notNull().unique(),
  device_id: text("device_id").notNull().unique(),
  name: text("name").notNull(),
  email: text("email").notNull().unique(),
  password_hash: text("password").notNull(),
});

// ãƒ†ãƒ¼ãƒ–ãƒ«å: teacher
// æ•™å¸«ã‚’ç®¡ç†ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«
const teacher = sqliteTable("teacher", {
  teacher_uuid: text("teacher_uuid").primaryKey().notNull(),
  teacher_id: integer("teacher_id").notNull().unique(),
  name: text("name").notNull(),
  password_hash: text("password").notNull(),
});

// ãƒ†ãƒ¼ãƒ–ãƒ«å: lesson
// æˆæ¥­ã‚’ç®¡ç†ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«
const lesson = sqliteTable("lesson", {
  lesson_uuid: text("lesson_uuid").primaryKey().notNull(),
  name: text("name").notNull(),
  teacher_uuid: text("teacher_uuid")
    .references(() => teacher.teacher_uuid)
    .notNull(),
  status: integer("status").notNull().default(0),
});

// ãƒ†ãƒ¼ãƒ–ãƒ«å: regilesson
// ç™»éŒ²ã•ã‚ŒãŸæˆæ¥­ã‚’ç®¡ç†ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«
const regilesson = sqliteTable("regilesson", {
  regilesson_uuid: text("regilesson_uuid").primaryKey().notNull(),
  student_uuid: text("student_uuid")
    .notNull()
    .references(() => student.student_uuid),
  lesson_uuid: text("lesson_uuid")
    .notNull()
    .references(() => lesson.lesson_uuid),
});

// ãƒ†ãƒ¼ãƒ–ãƒ«å: attendance
// å‡ºå¸­ã‚’ç®¡ç†ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«
const attendance = sqliteTable("attendance", {
  attendance_uuid: text("attendance_uuid").primaryKey().notNull(),
  student_uuid: text("student_uuid")
    .notNull()
    .references(() => student.student_uuid),
  lesson_uuid: text("lesson_uuid")
    .notNull()
    .references(() => lesson.lesson_uuid),
  status: integer("status").notNull(),
});

// ç”Ÿå¾’ã®æŒã¤ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
const student_relation = relations(student, ({ many }) => ({
  regilessons: many(regilesson),
  attendances: many(attendance),
}));

// æ•™å¸«ã®æŒã¤ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
const teacher_relation = relations(teacher, ({ many }) => ({
  lessons: many(lesson),
}));

// æˆæ¥­ã®æŒã¤ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
const lesson_relation = relations(lesson, ({ one, many }) => ({
  posts: many(attendance),
  teacher: one(teacher, {
    fields: [lesson.teacher_uuid],
    references: [teacher.teacher_uuid],
  }),
}));

// ç™»éŒ²ã•ã‚ŒãŸæˆæ¥­ã®æŒã¤ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
const regilesson_relation = relations(regilesson, ({ one }) => ({
  student: one(student, {
    fields: [regilesson.student_uuid],
    references: [student.student_uuid],
  }),
  lesson: one(lesson, {
    fields: [regilesson.lesson_uuid],
    references: [lesson.lesson_uuid],
  }),
}));

// å‡ºå¸­ã®æŒã¤ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
const attendance_relation = relations(attendance, ({ one }) => ({
  student: one(student, {
    fields: [attendance.student_uuid],
    references: [student.student_uuid],
  }),
  lesson: one(lesson, {
    fields: [attendance.lesson_uuid],
    references: [lesson.lesson_uuid],
  }),
}));

export {
  student,
  teacher,
  lesson,
  regilesson,
  attendance,
  student_relation,
  teacher_relation,
  lesson_relation,
  regilesson_relation,
  attendance_relation,
};
```

:::

:::details ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ´»ã‹ã—ãŸã‚¯ã‚¨ãƒª

```ts
// [èªè¨¼æ•™å¸«] ç‰¹å®šã®æ•™å¸«ã®æˆæ¥­ã®ä¸€è¦§ã‚’å–å¾—ã™ã‚‹
app_hono.get("/teachers/:teacher_uuid/lessons", async (c) => {
  const db = drizzle(c.env.DB, {
    schema: {
      lesson: lesson,
      teacher: teacher,
      lesson_relation: lesson_relation,
    },
  });

  const teacher_uuid = c.req.param().teacher_uuid;
  const result = await db.query.lesson.findMany({
    where: eq(lesson.teacher_uuid, teacher_uuid),
    columns: {
      lesson_uuid: true,
      name: true,
      status: true,
    },
    with: {
      teacher: true,
    },
  });

  return c.json(result, 200);
});
```

:::

https://orm.drizzle.team/docs/rqb#declaring-relations

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: IDaaS ã¨é€£æºã™ã‚‹ or è‡ªå‰ã§èªè¨¼æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ã‹è¿·ã£ãŸ

IDaaS ã¨é€£æºã—ã¦ JWT ã®æ¤œè¨¼ã«å¾¹ã™ã‚‹ã‹ã€è‡ªå‰ã§èªè¨¼æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ã‹è¿·ã„ã¾ã—ãŸã€‚

çµå±€ã€è‡ªå‰ã§èªè¨¼æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚ç”Ÿå¾’ç”¨ã¨æ•™å¸«ç”¨ã®äºŒç¨®é¡ã®ãƒ­ã‚°ã‚¤ãƒ³ã‚’å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€IDaaS ã¨é€£æºã™ã‚‹ã¨ã€ãã‚Œãã‚Œã®ãƒ­ã‚°ã‚¤ãƒ³ã«å¯¾å¿œã™ã‚‹ã“ã¨ã«ãªã£ã¦é¢å€’ã ã£ãŸãŸã‚ã§ã™ã€‚

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‘¨ã‚Šã®å‡¦ç†

ã•ã¦ã€è‡ªå‰ã§èªè¨¼ã‚’å®Ÿè£…ã™ã‚‹ã¨ãªã‚‹ã¨ã€ä»¥ä¸‹ã®å‡¦ç†ãŒå¿…è¦ã¨ãªã£ã¦ãã¾ã™ã€‚

- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ
- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆèªè¨¼ã¨ JWT ç™ºè¡Œ

ã¾ãšã¯ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆãªã®ã§ã™ãŒã€Cloudflare Workers ä¸Šã§ bcrypt-js ã‚’å‹•ä½œã•ã›ã¦ã„ã¾ã™ã€‚

![](/images/c5ae165b16b969/2023-12-20-18-30-41.png)

CPU æ™‚é–“ã®ä¸Šé™ã¨ã‹ã‚ã‚‹ã£ã½ã„ã§ã™ãŒã€ãªã‚“ã‹æ­£å¸¸ã«å‹•ãã¾ã—ãŸã€€ã‚ˆã‹ã£ãŸï½
https://developers.cloudflare.com/workers/platform/limits

ã‚¢ã‚«ã‚¦ãƒ³ãƒˆèªè¨¼ã¨ JWT ç™ºè¡Œã«ã¤ã„ã¦ã¯ã€Hono ã® JWT ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’ä½¿ã£ã¦å®Ÿè£…ã—ã¾ã—ãŸã€‚

![](/images/c5ae165b16b969/2023-12-20-18-32-56.png)

ãƒ¨ã‚·ï¼

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: å‡ºå¸­ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®å‹•ä½œãƒ•ãƒ­ãƒ¼è¨­è¨ˆ

å‡ºå¸­ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®å‹•ä½œãƒ•ãƒ­ãƒ¼ã‚’ã¼ã‚“ã‚„ã‚Šã¨è€ƒãˆã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

- æ•™å¸«ãŒæˆæ¥­ã‚’ä½œæˆã™ã‚‹
- ç”Ÿå¾’ãŒãã® ID ã‚’å‚ç…§ã—ã¦ã€æˆæ¥­ã«å±¥ä¿®ã™ã‚‹
- æ•™å¸«ãŒæˆæ¥­ã‚’é–‹å§‹ã™ã‚‹
- ç”Ÿå¾’ãŒå‡ºå¸­ã™ã‚‹
- æ•™å¸«ãŒæˆæ¥­ã‚’çµ‚äº†ã™ã‚‹

ã§ã¯ã€ã“ã®ãƒ•ãƒ­ãƒ¼ã‚’åŸºã«ã€å®Ÿéš›ã®å‹•ä½œã‚’çµ„ã‚“ã§ã¿ã¾ã—ã‚‡ã†ã€‚

#### æ•™å¸«ãŒæˆæ¥­ã‚’ä½œæˆã™ã‚‹

ã“ã‚Œã¯ã€æ•™å¸«ãŒæˆæ¥­ã‚’ä½œæˆã™ã‚‹ã¨ãã«ã€æˆæ¥­ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§å®Ÿç¾ã§ãã¾ã™ã€‚

#### ç”Ÿå¾’ãŒãã® ID ã‚’å‚ç…§ã—ã¦ã€æˆæ¥­ã«å±¥ä¿®ã™ã‚‹

ã“ã‚Œã¯ã€ç”Ÿå¾’ãŒæˆæ¥­ã«å±¥ä¿®ã™ã‚‹ã¨ãã«ã€å±¥ä¿®ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§å®Ÿç¾ã§ãã¾ã™ã€‚

#### æ•™å¸«ãŒæˆæ¥­ã‚’é–‹å§‹ã™ã‚‹

å•é¡Œã¯ã€æ•™å¸«ãŒæˆæ¥­ã‚’é–‹å§‹ã™ã‚‹ã¨ãã§ã™ã€‚

æ•™å¸«ãŒæˆæ¥­ã‚’é–‹å§‹ã™ã‚‹ã¨ãã«ã€æˆæ¥­ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®é–‹å§‹ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã¾ã™ãŒã€ã“ã®ã¨ãã«ã©ã®ã‚ˆã†ãªå‡¦ç†ã‚’è¡Œã†ã¹ãã‹è€ƒãˆã¦ã¿ã‚‹ã¨ãƒ»ãƒ»ãƒ»

> ã€Œç”Ÿå¾’ã®å‡ºå¸­ã¯ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¦‹ã‚‰ã‚Œã‚‹å¿…è¦ãŒã‚ã‚‹ãªã‚‰ã€æ•™å¸«ãŒæˆæ¥­ã‚’é–‹å§‹ã—ãŸã¨ãã«ã€ç”Ÿå¾’ã®å‡ºå¸­ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚ã‚‰ã‹ã˜ã‚å‡ºå¸­ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã®ã§ã¯ï¼Ÿã€

ã“ã†è€ƒãˆã€æ•™å¸«ãŒæˆæ¥­ã‚’é–‹å§‹ã™ã‚‹ã¨ãã«ã€å‡ºå¸­ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã«ç”Ÿå¾’ã®å‡ºå¸­ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

#### ç”Ÿå¾’ãŒå‡ºå¸­ã™ã‚‹

ã“ã“ã§ã€ç”Ÿå¾’ãŒå‡ºå¸­ã™ã‚‹ã¨ãã«ã€å‡ºå¸­ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®å‡ºå¸­ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã¾ã™ãŒãƒ»ãƒ»ãƒ»ã€‚

ç”Ÿå¾’ã®å‡ºå¸­ã¯ã€ç”Ÿå¾’ã® Bluetooth ã‚’æ¤œçŸ¥ã™ã‚‹ã“ã¨ã§è¡Œã†ã“ã¨ã«ãªã£ã¦ã„ã¾ã™ã€‚

ãŸã¨ãˆã°ã€ãƒ¦ãƒ¼ã‚¶å›ºæœ‰ã® Bluetooth ID ãŒã‚ã‚Šã€ãã‚Œã‚’æ¤œçŸ¥ã™ã‚‹ã“ã¨ã§å‡ºå¸­ã‚’åˆ¤å®šã™ã‚‹ã¨ã—ã¾ã™ã€‚ã“ã®ã¨ãã€Bluetooth ID ã‚’æ¤œçŸ¥ã™ã‚‹ãƒ¬ãƒ¼ãƒ€ãƒ¼ã®ã‚ˆã†ãªã‚‚ã®ãŒã€10 ç§’ãŠãã«ç”Ÿå¾’ã® Bluetooth ID ã®ãƒªã‚¹ãƒˆã‚’ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒã«é€ä¿¡ã™ã‚‹ã‚‚ã®ã¨ã—ã¾ã™ã€‚

ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãŒãã®ãƒªã‚¹ãƒˆã‚’å—ã‘ä»˜ã‘ãŸã¨ãã€æ¯å›ã™ã¹ã¦ã®ç”Ÿå¾’ã®ãƒ‡ãƒã‚¤ã‚¹ ID ã‚’æ¤œç´¢ã—ã€ãã‚Œã«ä¸€å¯¾ä¸€ã§å¯¾å¿œã™ã‚‹ç”Ÿå¾’ã®å‡ºå¸­ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ›´æ–°ã™ã‚‹ã¨ã„ã†ã®ã¯ã€ã‚ã¾ã‚Šã«ã‚‚è² è·ãŒé«˜ã„ã§ã™ã€‚

ã—ãŸãŒã£ã¦ã€ã“ã“ã§ã‚­ãƒ¼ãƒãƒªãƒ¥ãƒ¼ã‚¹ãƒˆã‚¢ã‚’ä¸Šæ‰‹ãä½¿ã„ãŸã„ã¨æ€ã„ã¾ã™ã€‚

> ã€Œå‡ºå¸­æƒ…å ±ã‚’å—ã‘ä»˜ã‘ã‚‹ API ã®å‡¦ç†ã¯ã€æˆæ¥­ã® ID ã¨ç”Ÿå¾’ã®ãƒ‡ãƒã‚¤ã‚¹ ID ã‚’ã‚­ãƒ¼ã¨ã—ã¦ã€ç”Ÿå¾’ãŒå‡ºå¸­ã—ãŸã“ã¨ã‚’ã‚­ãƒ¼ãƒãƒªãƒ¥ãƒ¼ã‚¹ãƒˆã‚¢ã«æ ¼ç´ã™ã‚‹ã ã‘ã«ã¨ã©ã‚ã‚ˆã†ã€
> ã€Œãã®ä»£ã‚ã‚Šã€ãƒãƒƒãƒå‡¦ç†ã§ã‚ˆã‚Šå¤§ããªé–“éš”ã§ã€ç”Ÿå¾’ã®ãƒ‡ãƒã‚¤ã‚¹ ID ã‚’æ¤œç´¢ã—ã€ãã‚Œã«ä¸€å¯¾ä¸€ã§å¯¾å¿œã™ã‚‹ç”Ÿå¾’ã®å‡ºå¸­ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ›´æ–°ã™ã‚‹ã‚ˆã†ã«ã—ã‚ˆã†ã€

ã“ã†è€ƒãˆã¾ã—ãŸã€‚

#### ãƒãƒƒãƒå‡¦ç† â†NEW

ãƒãƒƒãƒå‡¦ç†ã§ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªå‡¦ç†ã‚’è¡Œã„ã¾ã™ã€‚

- ã‚­ãƒ¼ãƒãƒªãƒ¥ãƒ¼ã‚¹ãƒˆã‚¢ã‹ã‚‰ã€ç¾åœ¨å‡ºå¸­ã—ã¦ã„ã‚‹ç”Ÿå¾’ã®ãƒ‡ãƒã‚¤ã‚¹ ID ã‚’ã™ã¹ã¦å–å¾—ã™ã‚‹
- å½“è©²æˆæ¥­ã‚’å±¥ä¿®ã—ã¦ã„ã‚‹ç”Ÿå¾’ã®ãƒ‡ãƒã‚¤ã‚¹ ID ã¨ç”Ÿå¾’ ID ã‚’ã™ã¹ã¦å–å¾—ã™ã‚‹
- å‡ºå¸­ãŒã™ã§ã«å®Œäº†ã—ã¦ã„ã‚‹ç”Ÿå¾’ã®ç”Ÿå¾’ ID ã‚’ã™ã¹ã¦å–å¾—ã™ã‚‹
- å½“è©²æˆæ¥­ã‚’å±¥ä¿®ã—ã¦ã„ã‚‹ç”Ÿå¾’ã®ãƒ‡ãƒã‚¤ã‚¹ ID ãƒªã‚¹ãƒˆã‹ã‚‰ã€
  - å‡ºå¸­ãŒã™ã§ã«å®Œäº†ã—ã¦ã„ã‚‹ç”Ÿå¾’ã®ãƒ‡ãƒã‚¤ã‚¹ ID ã‚’é™¤å¤–
  - è©²å½“ã™ã‚‹ã‚­ãƒ¼ãƒãƒªãƒ¥ãƒ¼ã‚¹ãƒˆã‚¢ã®ãƒ‡ãƒã‚¤ã‚¹ ID ã«å«ã¾ã‚Œãªã„ç”Ÿå¾’ã®ãƒ‡ãƒã‚¤ã‚¹ ID ã‚’é™¤å¤–
    ã—ã€æ®‹ã£ãŸç”Ÿå¾’ã®ç”Ÿå¾’ ID ã‚’å–å¾—
- æ®‹ã£ãŸç”Ÿå¾’ã®ç”Ÿå¾’ ID ã«å¯¾å¿œã™ã‚‹å‡ºå¸­ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ã€å‡ºå¸­ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã¦æ›´æ–°ã™ã‚‹

ã¨ã„ã†å‡¦ç†ã‚’è¡Œã£ã¦ã„ã¾ã™ã€‚

:::message
ã“ã®è¨˜è¿°ã‚’æ›¸ã„ã¦ã„ã¦ã€ã‚‚ã£ã¨ã“ã®å‡¦ç†ã‚’ç°¡å˜ã«æ›¸ã‘ã‚‹ã®ã‹ã‚‚ã—ã‚Œãªã„ã¨æ€ãˆã¦ãã¾ã—ãŸãƒ»ãƒ»ãƒ»ã€‚
æˆæ¥­ã«å±¥ä¿®ã—ã¦ã„ã‚‹ ã‹ã¤ å‡ºå¸­ãŒå®Œäº†ã—ã¦ã„ãªã„ç”Ÿå¾’ã®ç”Ÿå¾’ ID & ãƒ‡ãƒã‚¤ã‚¹ ID ã‚’å–å¾—ã™ã‚‹ã€ã¨ã„ã†å‡¦ç†ã‚’ã€ä¸€åº¦ã«è¡Œãˆã°ã„ã„ã®ã‹ã‚‚ã€‚
:::

#### æ•™å¸«ãŒæˆæ¥­ã‚’çµ‚äº†ã™ã‚‹

æ•™å¸«ãŒæˆæ¥­ã‚’çµ‚äº†ã—ãŸã¨ãã€å‡ºå¸­ç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®çµ‚äº†ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã¾ã™ã€‚
ã¾ãŸã€ã‚­ãƒ¼ãƒãƒªãƒ¥ãƒ¼ã‚¹ãƒˆã‚¢ã‚’æƒé™¤ã—ã¾ã™ã€‚

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: èªå¯å‡¦ç†

èªå¯å‡¦ç†ã¯ã€Hono ã® JWT ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’ä½¿ã£ã¦å®Ÿè£…ã—ã¾ã—ãŸã€‚

ã“ã“ã§ã€ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã‚‹ãƒ‘ã‚¹ã¨ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ã«ã‚ˆã£ã¦èªå¯ã®å‡¦ç†ã‚’åˆ‡ã‚Šåˆ†ã‘ãŸã‹ã£ãŸã®ã§ã™ãŒã€Hono ã® Middleware ã¯ã€ãƒ‘ã‚¹ã”ã¨ã«ã—ã‹è¨­å®šã§ããªã„ã‚ˆã†ã§ã—ãŸã€‚

ã—ãŸãŒã£ã¦ã€JWT ã® Middlware ã®å†…éƒ¨å®Ÿè£…ã‚’è»½ãèª­ã‚“ã§ã‹ã‚‰ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã€ãƒ‘ã‚¹ã«ã‚ˆã£ã¦èªå¯å‡¦ç†ã‚’åˆ‡ã‚Šåˆ†ã‘ã¾ã—ãŸã€‚

:::details èªå¯å‡¦ç†ã®ã‚³ãƒ¼ãƒ‰

```ts
// èªè¨¼ã‚’è¨­å®šã™ã‚‹ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
app_hono.use("*", async (c, next) => {
  console.debug("[*] èªè¨¼ã‚’è¨­å®šã™ã‚‹ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’å®Ÿè¡Œã—ã¦ã„ã¾ã™ã€‚");
  // èªè¨¼ã®å¿…è¦ãªã„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹
  const path = c.req.path;

  // ã‚‚ã—ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ãƒ‘ã‚¹ãŒå­˜åœ¨ã—ã€ã‹ã¤ãƒ¡ã‚½ãƒƒãƒ‰ãŒä¸€è‡´ã™ã‚‹å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹
  if (
    allow_path_list.some(
      (allow_path) =>
        allow_path.path === path && allow_path.method === c.req.method
    )
  ) {
    // èªè¨¼ã‚’ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹
    console.log("[*] èªè¨¼ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™ã€‚");
    await next();
    return;
  }

  // èªè¨¼ã‚’è¡Œã†
  await jwt({
    secret: c.env.JWT_SECRET_KEY,
    alg: "HS256",
  })(c, async () => {});
  // ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹
  const payload = c.get("jwtPayload") as JWTPayload;

  console.debug("[*] ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚", payload);

  if (payload.type === "student") {
    console.debug("[*] ç”Ÿå¾’ã¨ã—ã¦èªè¨¼ã—ã¾ã™ã€‚");
    // ç”Ÿå¾’ã¨ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ã¿è¨±å¯ã™ã‚‹
    if (
      !student_path_list.some(
        (student_path) =>
          student_path.path === path && student_path.method === c.req.method
      )
    ) {
      console.debug("[!] ç”Ÿå¾’ã¨ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚");
      return c.json(
        {
          error: "ç”Ÿå¾’ã¨ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã™",
        },
        403
      );
    }
  } else if (payload.type === "teacher") {
    console.debug("[*] æ•™å¸«ã¨ã—ã¦èªè¨¼ã—ã¾ã™ã€‚");
    // æ•™å¸«ã¨ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ã¿è¨±å¯ã™ã‚‹
    if (
      !teacher_path_list.some(
        (teacher_path) =>
          teacher_path.path === path && teacher_path.method === c.req.method
      )
    ) {
      console.debug("[!] æ•™å¸«ã¨ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚");
      return c.json(
        {
          error: "æ•™å¸«ã¨ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã™",
        },
        403
      );
    }
  } else {
    console.debug("[!] èªè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");
    return c.json(
      {
        error: "èªè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸ",
      },
      403
    );
  }

  console.debug("[*] èªè¨¼ã«æˆåŠŸã—ã¾ã—ãŸã€‚");
  // å‡¦ç†ã‚’ç¶šè¡Œã™ã‚‹
  await next();
});
```

:::

:::details èªå¯å‡¦ç†ã®ãƒ‘ã‚¹

```ts
// èªè¨¼ãªã—ã§ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã™ã‚‹ãƒ‘ã‚¹ã®åˆ—æŒ™
// ãƒ¡ã‚½ãƒƒãƒ‰ã‚‚å«ã‚€
const allow_path_list = [
  {
    path: "/students",
    method: "POST",
  },
  {
    path: "/teachers",
    method: "POST",
  },
  {
    path: "/students/login",
    method: "POST",
  },
  {
    path: "/teachers/login",
    method: "POST",
  },
  {
    path: "/attendances-endpoint",
    method: "POST",
  },
];

// ç”Ÿå¾’ã¨ã—ã¦èªè¨¼ã‚’è¨­å®šã™ã‚‹ãƒ‘ã‚¹ã®åˆ—æŒ™
// ãƒ¡ã‚½ãƒƒãƒ‰ã‚‚å«ã‚€
const student_path_list = [
  {
    path: "/students/me",
    method: "GET",
  },
  {
    path: "/lessons/:lesson_uuid",
    method: "GET",
  },
  {
    path: "/join-lessons",
    method: "POST",
  },
  {
    path: "/students/me/join-lessons",
    method: "GET",
  },
  {
    path: "/students/me/attendances",
    method: "GET",
  },
];

// å…ˆç”Ÿã¨ã—ã¦èªè¨¼ã‚’è¨­å®šã™ã‚‹ãƒ‘ã‚¹ã®åˆ—æŒ™
// ãƒ¡ã‚½ãƒƒãƒ‰ã‚‚å«ã‚€
const teacher_path_list = [
  {
    path: "/teachers/me",
    method: "GET",
  },
  {
    path: "/students",
    method: "GET",
  },
  {
    path: "/students/:student_uuid",
    method: "GET",
  },
  {
    path: "/teachers",
    method: "GET",
  },
  {
    path: "/teachers/:teacher_uuid",
    method: "GET",
  },
  {
    path: "/teachers/:teacher_uuid/lessons",
    method: "GET",
  },
  {
    path: "/teachers/me/lessons",
    method: "GET",
  },
  {
    path: "/lessons",
    method: "POST",
  },
  {
    path: "/lessons/:lesson_uuid",
    method: "GET",
  },
  {
    path: "/students/:student_uuid/join-lessons",
    method: "GET",
  },
  {
    path: "/students/:student_uuid/attendances",
    method: "GET",
  },
  // {
  // 	path: '/lessons/:lesson_uuid/attendances',
  // 	method: 'GET',
  // },
  {
    path: "/lessons/particular/attendances",
    method: "POST",
  },
  {
    path: "/lessons/start",
    method: "POST",
  },
  {
    path: "/lessons/end",
    method: "POST",
  },
];

export { allow_path_list, student_path_list, teacher_path_list };
```

:::

ã—ã‹ã—ï¼ã“ã®æ–¹æ³•ã ã¨ã€RESTAPI ç‰¹æœ‰ã®ã€Œãƒ‘ã‚¹ã®ä¸­ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’åŸ‹ã‚è¾¼ã‚€ã€æŒ™å‹•ãŒå…¨éƒ¨ä½¿ãˆãªããªã‚Šã¾ã™ã€‚

ã¤ã‚‰ã„ãƒ»ãƒ»ãƒ»

REST ã«æ²¿ã‚ãªã„ã€å¤‰ãª POST ãŒ API ã«å­˜åœ¨ã™ã‚‹ã®ã¯ãã®ãŸã‚ã§ã™ãƒ»ãƒ»ãƒ»ã€‚

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: CORS ã®è¨­å®š

ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ã¤ãªãã“ã¿ã—ãŸã¨ãã«ã€CORS ã®ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã€Authorization ãƒ˜ãƒƒãƒ€ãŒå–å¾—ã§ããªã„ã¨ã„ã†å•é¡ŒãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚

ã“ã‚Œã¯ã€Cloudflare Workers ã®è¨­å®šã§ã€CORS ã‚’è¨±å¯ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ãŒåŸå› ã§ã—ãŸã€‚

:::details CORS ã®è¨­å®š

```ts
app_hono.use(
  "*",
  cors({
    origin: [
      "http://localhost:5173",
      "http://127.0.0.1:5173",
      "https://pbl-page.pages.dev",
    ],
    allowMethods: ["GET", "POST", "PUT", "DELETE", "OPTIONS"],
    allowHeaders: ["Authorization", "Content-Type"],
    exposeHeaders: ["Authorization"],
    maxAge: 86400,
  })
);
```

:::

ã“ã®ã‚ˆã†ã«è¨­å®šã™ã‚‹ã“ã¨ã§ã€CORS ã®ã‚¨ãƒ©ãƒ¼ãŒè§£æ¶ˆã•ã‚Œã¾ã—ãŸã€‚
allowHeaders ã¨ ExposeHeaders ã« Authorization ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€Authorization ãƒ˜ãƒƒãƒ€ã‚’å–å¾—ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã®å®Ÿè£…

ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã®å®Ÿè£…ã§ã™ãŒã€ä»Šå›ã¯å¤–éƒ¨å®Ÿè£…ã‚’ä½¿ã‚ãšã€è‡ªå‰ã§å®Ÿè£…ã—ã¾ã—ãŸã€‚

ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ä¿æŒã¯ SessionStorage ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™(é¢å€’ã ã£ãŸã®ã§ãƒ»ãƒ»ãƒ»ã”ã‚ã‚“ãªã•ã„)

(ã¨ã„ã†ã‹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒãˆã‚‹ã®ã§ã‚ã‚Œã° Authorization ãƒ˜ãƒƒãƒ€ã« JWT ã‚’å…¥ã‚Œã‚‹ã®ã§ã¯ãªãã€Cookie ã« JWT ã‚’å…¥ã‚Œã‚‹ã¹ãã ã£ãŸã‹ã‚‚ã—ã‚Œãªã„ã€€ã¾ã‚ã„ã„ã‹ãƒ»ãƒ»ãƒ»)

SessionStorage ã®æƒ…å ±ã‚’ãƒ•ãƒƒã‚¯ã¨ã—ã¦åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’ä½œæˆã—ã¾ã—ãŸã€‚

useSyncExternalStore ãƒ•ãƒƒã‚¯ã‚’åˆ©ç”¨ã—ã¦ã€SessionStorage ã®æƒ…å ±ã‚’ãƒ•ãƒƒã‚¯ã¨ã—ã¦åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

:::details ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯

```ts
import { useSyncExternalStore, useCallback } from "react";

const useSessionStorage = <T>(key: string, initialValue: T) => {
  // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰å€¤ã‚’èª­ã¿è¾¼ã‚€
  const getStoredValue = useCallback(() => {
    const storedValue = sessionStorage.getItem(key);
    return storedValue ? JSON.parse(storedValue) : initialValue;
  }, [key, initialValue]);

  // React ã«å¤–éƒ¨ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã®å¤‰æ›´ã‚’é€šçŸ¥ã™ã‚‹ãŸã‚ã®é–¢æ•°
  const subscribe = useCallback(
    (notifyChange: () => void) => {
      const handleChange = (event: StorageEvent) => {
        if (event.key === key) {
          notifyChange();
        }
      };
      window.addEventListener("storage", handleChange);
      return () => window.removeEventListener("storage", handleChange);
    },
    [key]
  );

  // useSyncExternalStore ã‚’ä½¿ç”¨ã—ã¦ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®å€¤ã¨åŒæœŸ
  const value = useSyncExternalStore(subscribe, getStoredValue);

  // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«å€¤ã‚’è¨­å®šã™ã‚‹é–¢æ•°
  const setValue = useCallback(
    (newValue: T) => {
      const stringifiedValue = JSON.stringify(newValue);
      sessionStorage.setItem(key, stringifiedValue);
      // subscribeã‚’é€šã˜ã¦å¤‰æ›´ã‚’æ‰‹å‹•ã§é€šçŸ¥ã™ã‚‹å ´åˆã€ã“ã“ã«å‡¦ç†ã‚’è¿½åŠ ã™ã‚‹
    },
    [key]
  );

  return [value, setValue];
};

export { useSessionStorage };
```

:::

ã“ã‚Œã‚‚ chatgpt ã«è¨˜è¿°ã—ã¦ã‚‚ã‚‰ã„ã¾ã—ãŸ

ãƒ­ã‚°ã‚¤ãƒ³ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚„ provider ã¯ä»¥ä¸‹ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ç®¡ç†ã—ã¦ã„ã¾ã™ã€‚

https://github.com/calloc134/pbl-frontend/tree/master/src/features/student/context

:::details provider

```ts
import { FC, ReactNode, useCallback } from "react";
import { JwtContext } from "./CredentialContext";
import { JwtStudentPayloadType, IJwtStudentContext } from "../types/jwtType";
import { decode } from "js-base64";
import { useSessionStorage } from "./useSessionStorage";

// ãƒ—ãƒ­ãƒã‚¤ãƒ€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

const JwtProvider: FC<{ children: ReactNode }> = ({ children }) => {
  const [jwtToken, setJwtToken] = useSessionStorage<string | null>(
    "StudentJwtToken",
    null
  );

  const getJwtPayload = useCallback((): JwtStudentPayloadType | null => {
    if (!jwtToken) {
      console.debug("jwtToken is null");
      return null;
    }
    console.debug("jwtToken", jwtToken);

    const payload = jwtToken.split(".")[1];
    // base64ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰
    const decodedPayload = decode(payload);
    return JSON.parse(decodedPayload);
  }, [jwtToken]);

  // JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’å‰Šé™¤ã—ã€ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã™ã‚‹
  const deleteJwtTokenAndLogout = useCallback(() => {
    setJwtToken(null);
  }, [setJwtToken]);

  // ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ—ãƒ­ãƒã‚¤ãƒ€ã®å€¤
  const contextValue: IJwtStudentContext = {
    jwtToken,
    setJwtToken,
    getJwtPayload,
    deleteJwtTokenAndLogout,
  };

  return (
    <JwtContext.Provider value={contextValue}>{children}</JwtContext.Provider>
  );
};

export { JwtContext, JwtProvider };
```

:::

:::message
(æ›¸ã„ã¦ã¦æ€ã£ãŸã‚“ã§ã™ãŒ è¡Œå„€ã®ã‚ˆã„æ›¸ãæ–¹ãªã®ã‹ä¸å®‰ã§ã™ ã†ãƒ¼ã‚“)

:::

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¯æ’ä¾‹ã® Tanstack Router ã‚’ä½¿ã£ã¦å®Ÿè£…ã—ã¾ã—ãŸã€‚

:::details ãƒ«ãƒ¼ãƒˆã®å®šç¾©

```ts
const router = new Router({
  routeTree: root_route.addChildren([
    index_route.addChildren([
      student_route.addChildren([
        student_register_route,
        student_login_route,
        student_auth_route.addChildren([
          student_info_route,
          student_attendance_route,
          student_course_route,
          student_add_course_route,
          student_logout_route,
        ]),
        teacher_route.addChildren([
          teacher_register_route,
          teacher_login_route,
          teacher_auth_route.addChildren([
            teacher_info_route,
            teacher_all_students_route,
            teacher_all_teachers_route,
            teacher_all_lessons_route,
            teacher_add_lesson_route,
            teacher_attendance_route,
            teacher_logout_route,
          ]),
        ]),
      ]),
    ]),
    not_found_route,
  ]),
});
```

:::

å‹å®‰å…¨ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ¨ã—ã§ã™
tanstack router ã®æ¨ã—ãƒã‚¤ãƒ³ãƒˆã«ã¤ã„ã¦ã‚‚ä»Šå¾Œæ›¸ã„ã¦ã„ããŸã„ã€‚

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: ã‚¯ã‚¨ãƒª

ä»Šå›ã¯ Tanstack Query ã‚’åˆ©ç”¨ã—ã€ãã®éƒ¨åˆ†ã‚’ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã«åˆ‡ã‚Šå‡ºã—ã¦ã„ã¾ã™ã€‚

:::details ã‚¯ã‚¨ãƒªã®ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯

```tsx
// è‡ªåˆ†ã®éå»ã®å‡ºå¸­ã‚’ã™ã¹ã¦å–å¾—ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
import { useQuery } from "@tanstack/react-query";
import { useJwtToken } from "../context/useJWTToken";
const useMyAttendanceFetch = () => {
  const { jwtToken } = useJwtToken();

  const { data, isLoading, error } = useQuery({
    queryKey: ["student", "me", "attendances"],
    queryFn: async () => {
      const response = await fetch(
        "https://pbl-gairon-test.calloc134personal.workers.dev/students/me/attendances",
        {
          headers: {
            Authorization: `Bearer ${jwtToken}`,
          },
        }
      );
      const data = await response.json();
      return data as {
        status: number;
        attendance_uuid: string;
        lesson: {
          name: string;
          lesson_uuid: string;
          status: 0 | 1 | 2;
          teacher: {
            name: string;
            password_hash: string;
            teacher_uuid: string;
            teacher_id: number;
          };
        };
      }[];
    },
  });
  return { data, isLoading, error };
};

export { useMyAttendanceFetch };
```

:::

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

æ„å¤–ã¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆãŒç¶ºéº—ã«ã¾ã¨ã¾ã£ãŸæ°—ãŒã—ã¦ã„ã¾ã™

![](/images/c5ae165b16b969/2023-12-20-19-18-57.png)

:::message
ã©ã†ã ã‚ã†ãƒ»ãƒ»ãƒ»

:::

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ

Panda CSS ã®æ©Ÿèƒ½ã‚’ä½¿ã£ã¦ã€ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œã‚’è¡Œã„ã¾ã—ãŸã€‚

:::details ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ

```tsx
<div
  className={css({
    padding: 4,
    width: "60%", // Set the width to 60% of the screen size
    margin: "0 auto", // Center align the card
    border: "1px solid black", // Add a black border to the card
    borderRadius: 8, // Add rounded corners to the card
    display: "flex",
    flexDirection: "column",
    alignItems: "center",
  })}
>
  ...
</div>
```

:::

~~CSS è‹¦æ‰‹ã‹ã‚‚~~

## å®Œæˆã—ãŸã‚‚ã®

å®Œæˆã—ãŸã‚‚ã®ã¯ä»¥ä¸‹ã®ãƒªãƒã‚¸ãƒˆãƒªã«ã‚ã‚Šã¾ã™ã€‚

https://github.com/calloc134/pbl-backend

https://github.com/calloc134/pbl-frontend

![](/images/c5ae165b16b969/2023-12-20-19-20-09.png)

ãƒ›ãƒ¼ãƒ ç”»é¢ã§ã™ã€‚

![](/images/c5ae165b16b969/2023-12-20-19-20-26.png)

ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã§ã™ã€‚ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã„çŠ¶æ…‹ã§ãƒ­ã‚°ã‚¤ãƒ³ã®å¿…è¦ãªç”»é¢ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€ã“ã“ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã¾ã™ã€‚

![](/images/c5ae165b16b969/2023-12-20-19-21-11.png)

ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç™»éŒ²ç”»é¢ã§ã™ã€‚

![](/images/c5ae165b16b969/2023-12-20-19-22-19.png)

ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ãŸéš›ãªã©ã€ãƒˆãƒ¼ã‚¹ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

![](/images/c5ae165b16b969/2023-12-20-19-23-01.png)

ãƒ­ã‚°ã‚¤ãƒ³å¾Œã¯è‡ªåˆ†ã®æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

![](/images/c5ae165b16b969/2023-12-20-19-23-44.png)

ç”Ÿå¾’ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¨ã—ã¦ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

![](/images/c5ae165b16b969/2023-12-20-19-24-13.png)

æ•™å¸«ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¨ã—ã¦ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

![](/images/c5ae165b16b969/2023-12-20-19-24-53.png)

:::message
ä»¥é™ã¯è‡ªåˆ†ã§å®Ÿéš›ã«è§¦ã£ã¦ã‚‚ã‚‰ã£ãŸæ–¹ãŒã„ã„ã¨æ€ã†ã®ã§ã€ãƒªãƒ³ã‚¯ã‚’è²¼ã£ã¦ãŠãã¾ã™ã€‚
:::

https://pbl-page.pages.dev/

OGP ã‚‚è¨­å®šã—ã¾ã—ãŸï¼

## ä»Šå¾Œã®å±•æœ›ã¨åçœç‚¹

ä»Šå¾Œæ„è­˜ã—ãŸã„ã“ã¨ãŒã„ãã¤ã‹ã‚ã‚Šã¾ã™ã€‚

### API ã®ã‚¹ã‚­ãƒ¼ãƒå®šç¾©ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãŒã§ãã¦ã„ãªã„

ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã® API ã‚’æ—©æ€¥ã«ä½œã£ãŸãŸã‚ã€API ã®ã‚¹ã‚­ãƒ¼ãƒå®šç¾©ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãŒã§ãã¦ã„ã¾ã›ã‚“ã€‚

è‡ªåˆ†ã¯ã‚¹ã‚­ãƒ¼ãƒé§†å‹•é–‹ç™ºãŒå¤§å¥½ãäººé–“ã§ graphql ã‚’æ¨ã—ã¦ã„ã‚‹ã®ã§ã™ãŒã€ä»Šå›ã¯ãã“ã¾ã§æ‰‹ãŒå›ã‚Šã¾ã›ã‚“ã§ã—ãŸãƒ»ãƒ»ãƒ»

ã‚¹ã‚­ãƒ¼ãƒã‚’çµ±ä¸€ã—ã¦ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè£…ã‚’ãƒ•ãƒ­ãƒ³ãƒˆãƒãƒƒã‚¯çµ±ä¸€ã—ãŸã„ãƒ»ãƒ»ãƒ»ãã¬ã¬

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’åˆ†å‰²ã™ã‚‹

ç¾åœ¨ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ä¸€ã¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¾ã¨ã‚ã¦ã„ã¾ã™ã€‚

https://github.com/calloc134/pbl-backend/blob/master/src/index.ts

ã‚ˆããªã„ã§ã™ã­ãƒ»ãƒ»ãƒ»

é©åˆ‡ãªåˆ†é›¢ã‚’å‰å‘ãã«æ¤œè¨ã—ã¦ã„ã¾ã™ã€‚

### å‡ºå¸­ç®¡ç†ã‚»ãƒ³ã‚µã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã«èªè¨¼ã‚’è¿½åŠ 

ç¾åœ¨ã€å‡ºå¸­ç®¡ç†ã‚»ãƒ³ã‚µã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã«èªè¨¼ã‚’è¿½åŠ ã—ã¦ã„ã¾ã›ã‚“ã€‚

æ‚ªæ„ã®ã‚ã‚‹ç”Ÿå¾’ãŒã€å‡ºå¸­ç®¡ç†ã‚»ãƒ³ã‚µã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã«å½è£…ã—ã¦å‡ºå¸­ã‚’è¡Œã†ã“ã¨ãŒã§ãã¦ã—ã¾ã„ã¾ã™ã€‚ã“ã‚Œã¯å¤§å¤‰ã 

ä»¥å¾Œã€JWT ã‚’ä½¿ã£ã¦èªè¨¼ã‚’è¿½åŠ ã—ãŸã„ã§ã™ã€‚

### CSS ãŒæ±šã„

copilot ã‚’ãµã‚“ã ã‚“ã«åˆ©ç”¨ã—ã¦ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’ä½œæˆã—ãŸã®ã§ã™ãŒã€ã‚„ãŸã‚‰ marginBottom ã‚’åˆ©ç”¨ã—ãŸã‚³ãƒ¼ãƒ‰ã«ãªã£ã¦ã„ã¾ã™ã€‚
è„± margin ã—ã¦ padding ã¨ gap ã‚’ä½¿ã†ã‚ˆã†ã«ã—ãŸã„ãªã‚ãƒ»ãƒ»ãƒ»ã®ãŠæ°—æŒã¡ã§ã™ã€‚

## ãŠã‚ã‚Šã«

ä½•ã¯ã¨ã‚‚ã‚ã‚Œã€ç„¡äº‹ä¸€äººã§ãã‚Œã£ã½ã„å‡ºå¸­ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã§ãã¦ã€ã¨ã¦ã‚‚ã‚ˆã‹ã£ãŸã§ã™ï¼

å‰ã„ï¼

ãˆã‚‰ã„ãï½ï½ï½ï½ï½ï½ï½ï½ï½ï½

ä»Šã¾ã§è§¦ã‚ŒãŸã“ã¨ã®ãªã‹ã£ãŸæ–°æŠ€è¡“ã‚’ã‚´ãƒªã‚´ãƒªè§¦ã‚ŠãªãŒã‚‰ã€ãªã‚“ã¨ã‹å½¢ã«ã§ããŸã®ã§ã€ã™ã”ãã„ã„ä½“é¨“ã«ãªã‚Šã¾ã—ãŸã€‚
(å…ˆç”Ÿã‹ã‚‰ã‚‚è¤’ã‚ã‚‰ã‚Œã¾ã—ãŸã€€ã†ã‚Œã—ã‹ã£ãŸã§ã™)

å‹¢ã„ã§æ›¸ã„ãŸè¨˜äº‹ã§ã€ã¤ãŸãªã„ã¨ã“ã‚ãŒå¤šã„ã¨æ€ã„ã¾ã™ãŒã€æœ€å¾Œã¾ã§èª­ã‚“ã§ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼

## +Î± å¬‰ã—ã‹ã£ãŸã“ã¨

https://github.com/calloc134/pbl-backend/stargazers

é–‹ç™ºã—ãŸãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ãƒªãƒã‚¸ãƒˆãƒªã«ã€Hono ã®é–‹ç™ºè€…ã®æ–¹ã§ã‚ã‚‹@yusukebe ã•ã‚“ã‹ã‚‰ã‚¹ã‚¿ãƒ¼ã‚’ã„ãŸã ãã¾ã—ãŸï¼

ã™ã”ãå¬‰ã—ã„ã§ã™ï¼
